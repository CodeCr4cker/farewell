<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/CodeCr4cker/Web-Storage/main/Farewell-invitation-card/images/favicon.jpg" type="image/jpg" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <title>Golden Days of Our Batch</title>
        <meta name="description" content="Ending with Beautiful Beginnings">
         <meta name="description" content="
           This farewell website has been beautifully designed By Divyanshu Pandey to honor 
           and Celebrate the journey of all students of Class 12th As we say goodbye to this 
           wonderful chapter,let's celebrate the moments that made out time together unforgettable!"> 
         <meta name="description" content="">
    
    <meta property="og:image" content="https://raw.githubusercontent.com/CodeCr4cker/Web-Storage/main/Farewell-invitation-card/images/favicon.jpg">
<!--<meta property="og:url" content="https://farewell2025.netlify.app"> -->
<meta property="og:type" content="website">
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@400;600;700&display=swap"
      rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arbutus&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Architects+Daughter&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Geostar+Fill&display=swap">

    <style>
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Loader Styles - Updated Dark Theme */
      .loader-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        transition: opacity 0.5s ease-out;
      }

      .loader {
        text-align: center;
        color: white;
        position: relative;
      }

      /* New animated loader design */
      .loader-animation {
        width: 120px;
        height: 120px;
        position: relative;
        margin: 0 auto 30px;
      }

      .loader-ring {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        border: 3px solid transparent;
        border-top-color: #ffd700;
        animation: rotate 2s linear infinite;
      }

      .loader-ring:nth-child(2) {
        width: 80%;
        height: 80%;
        top: 10%;
        left: 10%;
        border-top-color: #ff6b6b;
        animation-duration: 1.5s;
        animation-direction: reverse;
      }

      .loader-ring:nth-child(3) {
        width: 60%;
        height: 60%;
        top: 20%;
        left: 20%;
        border-top-color: #4ecdc4;
        animation-duration: 1s;
      }

      .loader-center {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: #ffd700;
        animation: pulse 2s ease-in-out infinite;
      }

      .loader-text {
        font-family: "Poppins", sans-serif;
        font-size: 22px;
        font-weight: 300;
        letter-spacing: 2px;
        background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4);
        background-size: 200% 200%;
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: gradient 3s ease infinite;
      }

      @keyframes rotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes pulse {
        0%,
        100% {
          transform: translate(-50%, -50%) scale(1);
        }
        50% {
          transform: translate(-50%, -50%) scale(1.1);
        }
      }

      @keyframes gradient {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      /* Main Content - Dark Theme */
      .main-content {
        opacity: 0;
        transition: opacity 0.5s ease-in;
        display: none; /* Initially hidden */
      }

      /* Added for smooth fade-in after curtain */
      .main-content.fade-in-content {
        opacity: 1;
        transition: opacity 1s ease-in; /* Adjust duration and timing function as needed */
      }

      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Audio Control Button */
      .audio-control {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 1000;
        background: linear-gradient(135deg, #ffd700, #ffa500);
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        color: #333;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .audio-control:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 35px rgba(255, 215, 0, 0.4);
      }

      .audio-control.playing {
        animation: soundWaves 2s ease-in-out infinite;
      }

      @keyframes soundWaves {
        0%,
        100% {
          box-shadow: 0 8px 25px rgba(255, 215, 0, 0.3);
        }
        50% {
          box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6),
            0 0 0 10px rgba(255, 215, 0, 0.1), 0 0 0 20px rgba(255, 215, 0, 0.05);
        }
      }

      /* Album Access Modal - New Feature */
      .album-access-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9998;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
      }

      .album-access-modal.active {
        opacity: 1;
        pointer-events: all;
      }

      .access-form {
        background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        text-align: center;
        max-width: 400px;
        width: 90%;
        transform: scale(0.8) translateY(50px);
        transition: transform 0.3s ease;
        border: 2px solid rgba(255, 215, 0, 0.2);
      }

      .album-access-modal.active .access-form {
        transform: scale(1) translateY(0);
      }

      .access-title {
        font-family: "Dancing Script", cursive;
        font-size: 32px;
        color: #ffd700;
        margin-bottom: 20px;
        font-weight: 700;
        animation: glow-text 2s ease-in-out infinite alternate;
      }

      @keyframes glow-text {
        from {
          text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        to {
          text-shadow: 0 0 20px rgba(255, 215, 0, 0.8),
            0 0 30px rgba(255, 215, 0, 0.4);
        }
      }

      .access-description {
        color: #a0aec0;
        margin-bottom: 30px;
        font-size: 16px;
        line-height: 1.5;
      }

      .access-input {
        width: 100%;
        padding: 15px;
        margin: 15px 0;
        border: 2px solid #4a5568;
        border-radius: 10px;
        font-size: 18px;
        text-align: center;
        letter-spacing: 3px;
        font-weight: 600;
        font-family: "Poppins", sans-serif;
        background: #2d3748;
        color: white;
        transition: all 0.3s ease;
      }

      .access-input:focus {
        outline: none;
        border-color: #ffd700;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        transform: scale(1.02);
      }

      .access-input::placeholder {
        color: #a0aec0;
        letter-spacing: normal;
      }

      .access-button {
        background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
        color: #333;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin: 10px 5px;
        transition: all 0.3s ease;
        font-family: "Poppins", sans-serif;
        position: relative;
        overflow: hidden;
      }

      .access-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        transition: left 0.5s ease;
      }

      .access-button:hover::before {
        left: 100%;
      }

      .access-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
      }

      .access-button.secondary {
        background: #4a5568;
        color: white;
      }

      .error-message {
        background: linear-gradient(135deg, #e53e3e, #c53030);
        color: white;
        padding: 12px;
        border-radius: 8px;
        margin: 15px 0;
        display: none;
        animation: shake 0.5s ease-in-out;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-5px);
        }
        75% {
          transform: translateX(5px);
        }
      }

      /* Invitation Form Modal - Dark Theme */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
      }

      .modal-overlay.active {
        opacity: 1;
        pointer-events: all;
      }

      .invitation-form {
        background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        text-align: center;
        max-width: 400px;
        width: 90%;
        transform: translateY(50px);
        transition: transform 0.3s ease;
        border: 1px solid rgba(255, 215, 0, 0.2);
      }

      .modal-overlay.active .invitation-form {
        transform: translateY(0);
      }

      .form-title {
        font-family: "Dancing Script", cursive;
        font-size: 32px;
        color: #ffd700;
        margin-bottom: 20px;
        font-weight: 700;
      }

      .form-input {
        width: 100%;
        padding: 15px;
        margin: 10px 0;
        border: 2px solid #4a5568;
        border-radius: 10px;
        font-size: 16px;
        transition: border-color 0.3s ease;
        font-family: "Poppins", sans-serif;
        background: #2d3748;
        color: white;
      }

      .form-input:focus {
        outline: none;
        border-color: #ffd700;
      }

      .form-input::placeholder {
        color: #a0aec0;
      }

      .form-button {
        background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
        color: #333;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        margin: 10px 5px;
        transition: transform 0.3s ease;
        font-family: "Poppins", sans-serif;
      }

      .form-button:hover {
        transform: translateY(-2px);
      }

      .form-button.secondary {
        background: #4a5568;
        color: white;
      }

      /* Particle Animation - Dark Theme */
      .particles {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
      }

      .particle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: rgba(255, 215, 0, 0.6);
        border-radius: 50%;
        animation: float 6s ease-in-out infinite;
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(180deg);
        }
      }

      /* Header Decorations - Dark Theme with Animation */
      .decoration {
        position: absolute;
        z-index: 2;
        animation: decorationFloat 4s ease-in-out infinite;
      }

      .decoration img {
        width: 100%;
        height: 100%;
        object-fit: contain; /* Ensure the image fits within the container */
      }

      .top-right-decoration {
        top: 20px;
        right: 20px;
        width: 80px;
        height: 80px;
        background: rgba(255, 215, 0, 0.1); /* Background for the circular shape */
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: #ffd700;
        border: 2px solid rgba(255, 215, 0, 0.3);
      }

      .top-left-decoration {
        top: 20px;
        left: 20px;
        width: 80px;
        height: 80px;
        background: rgba(255, 107, 107, 0.1); /* Background for the circular shape */
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: #ff6b6b;
        border: 2px solid rgba(255, 107, 107, 0.3);
        animation-delay: -2s;
      }

      @keyframes decorationFloat {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-10px) rotate(5deg);
        }
      }

      /* Main Container */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
        z-index: 3;
      }

      /* Title Section - Dark Theme with Enhanced Animation */
      .title-section {
        text-align: center;
        margin: 80px 0 60px;
        position: relative;
        animation: slideInFromTop 1s ease-out;
      }

      @keyframes slideInFromTop {
        0% {
          transform: translateY(-50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .main-title {
        font-family: "Dancing Script", cursive;
        font-size: 4rem;
        font-weight: 700;
        background: linear-gradient(45deg, #ffd700, #ff6b6b);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
        animation: glow 3s ease-in-out infinite alternate, titleBounce 2s ease-in-out infinite;
      }

      @keyframes titleBounce {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .sub-title {
        font-family: "Dancing Script", cursive;
        font-size: 2.5rem;
        color: #e2e8f0;
        margin-bottom: 30px;
        font-weight: 600;
        animation: fadeInUp 1.5s ease-out;
      }

      @keyframes fadeInUp {
        0% {
          transform: translateY(30px);
          opacity: 0;
        }
        100% {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .event-details {
        background: rgba(45, 55, 72, 0.8);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 25px;
        margin: 20px 0;
        border: 1px solid rgba(255, 215, 0, 0.2);
        animation: slideInFromBottom 1.8s ease-out;
      }

      @keyframes slideInFromBottom {
        0% {
          transform: translateY(30px);
          opacity: 0;
        }
        100% {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .event-details p {
        color: #e2e8f0;
        font-size: 18px;
        font-weight: 400;
        line-height: 1.6;
      }

      .highlight {
        color: #ffd700;
        font-weight: 600;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        animation: textGlow 2s ease-in-out infinite alternate;
      }

      @keyframes textGlow {
        from {
          text-shadow: 0 2px 4px rgba(255, 215, 0, 0.3);
        }
        to {
          text-shadow: 0 2px 4px rgba(255, 215, 0, 0.8),
            0 0 10px rgba(255, 215, 0, 0.4);
        }
      }

      @keyframes glow {
        0% {
          filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
        }
        100% {
          filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.6));
        }
      }

      /* Enhanced Countdown Timer Design */
      .countdown-container {
        display: flex;
        justify-content: center;
        margin: 40px 0;
        animation: zoomIn 2s ease-out;
      }

      @keyframes zoomIn {
        0% {
          transform: scale(0.8);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .countdown {
        background: linear-gradient(135deg, rgba(45, 55, 72, 0.9) 0%, rgba(26, 32, 44, 0.9) 100%);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 40px;
        border: 2px solid rgba(255, 215, 0, 0.2);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        position: relative;
        overflow: hidden;
      }

      .countdown::before {
        content: "";
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4, #ffd700);
        background-size: 400% 400%;
        border-radius: 25px;
        z-index: -1;
        animation: gradientShift 3s ease infinite;
      }

      @keyframes gradientShift {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      .countdown-title {
        color: #ffd700;
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 30px;
        text-align: center;
        font-family: "Dancing Script", cursive;
        animation: sparkle 3s ease-in-out infinite;
      }

      @keyframes sparkle {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
          transform: scale(1.05);
        }
      }

      .countdown-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 25px;
        max-width: 700px;
      }

      .countdown-item {
        text-align: center;
        color: white;
        padding: 25px 15px;
        border-radius: 20px;
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 107, 107, 0.1));
        border: 2px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        animation: countdownPulse 4s ease-in-out infinite;
      }

      @keyframes countdownPulse {
        0%,
        100% {
          transform: scale(1);
        }
        25% {
          transform: scale(1.02);
        }
        50% {
          transform: scale(1);
        }
        75% {
          transform: scale(1.02);
        }
      }

      .countdown-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
      }

      .countdown-item:hover::before {
        left: 100%;
      }

      .countdown-item:hover {
        transform: translateY(-10px) scale(1.05);
        box-shadow: 0 15px 35px rgba(255, 215, 0, 0.3);
        border-color: #ffd700;
      }

      .countdown-number {
        font-size: 3rem;
        font-weight: 700;
        display: block;
        margin-bottom: 8px;
        background: linear-gradient(45deg, #ffd700, #ff6b6b);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        animation: numberFlip 1s ease-in-out;
      }

      /*    @keyframes numberFlip {
            0%, 100% { transform: rotateY(0); }
            50% { transform: rotateY(180deg); }
        } */

      .countdown-label {
        font-size: 16px;
        font-weight: 500;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #e2e8f0;
      }

      /* Action Buttons - Dark Theme with Enhanced Animation */
      .actions-container {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 40px 0;
        flex-wrap: wrap;
        animation: slideInFromLeft 2.2s ease-out;
      }

      .action-btn {
        background: rgba(45, 55, 72, 0.8);
        backdrop-filter: blur(10px);
        color: white;
        text-decoration: none;
        padding: 15px 25px;
        border-radius: 50px;
        border: 2px solid rgba(255, 215, 0, 0.3);
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        position: relative;
        overflow: hidden;
      }

      .action-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
      }

      .action-btn:hover::before {
        left: 100%;
      }

      .action-btn:hover {
        background: rgba(255, 215, 0, 0.2);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 10px 25px rgba(255, 215, 0, 0.2);
        border-color: #ffd700;
      }

      .invitation-btn {
        background: linear-gradient(135deg, #ffd700, #ffa500);
        color: #333;
        font-weight: 600;
        border-color: transparent;
        animation: buttonPulse 3s ease-in-out infinite;
      }

      @keyframes buttonPulse {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4);
        }
        50% {
          box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
        }
      }

      .invitation-btn:hover {
        background: linear-gradient(135deg, #ffed4e, #ffb347);
      }

      /* Photo Album Section */
      .photo-album-section {
        margin: 80px 0;
        padding: 40px 0;
        background: rgba(26, 32, 44, 0.6);
        backdrop-filter: blur(10px);
        border-radius: 30px;
        border: 1px solid rgba(255, 215, 0, 0.2);
        position: relative;
        overflow: hidden;
        animation: slideInFromRight 2.5s ease-out;
      }

      @keyframes slideInFromRight {
        0% {
          transform: translateX(50px);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .photo-album-section.locked {
        filter: blur(2px);
        pointer-events: none;
      }

      .photo-album-section.locked .album-container {
        /* Target album-container when section is locked */
        display: none; /* Hide the entire album content */
      }

      .photo-album-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.05), transparent);
        animation: shimmer 3s infinite;
      }

      @keyframes shimmer {
        0% {
          left: -100%;
        }
        100% {
          left: 100%;
        }
      }

      /* Album Lock Overlay */
      .album-lock-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10;
        border-radius: 30px;
        backdrop-filter: blur(5px);
        /* Ensure it covers the entire section */
        width: 100%;
        height: 100%;
      }

      .lock-icon {
        font-size: 4rem;
        color: #ffd700;
        margin-bottom: 20px;
        animation: lockShake 2s ease-in-out infinite;
      }

      @keyframes lockShake {
        0%,
        100% {
          transform: rotate(0deg);
        }
        25% {
          transform: rotate(-5deg);
        }
        75% {
          transform: rotate(5deg);
        }
      }

      .lock-message {
        color: #e2e8f0;
        font-size: 18px;
        text-align: center;
        margin-bottom: 20px;
        font-weight: 500;
      }

      .unlock-btn {
        background: linear-gradient(135deg, #ffd700, #ffa500);
        color: #333;
        border: none;
        padding: 15px 30px;
        border-radius: 50px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        animation: buttonGlow 3s ease-in-out infinite;
      }

      @keyframes buttonGlow {
        0%,
        100% {
          box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        50% {
          box-shadow: 0 0 30px rgba(255, 215, 0, 0.6),
            0 0 40px rgba(255, 215, 0, 0.2);
        }
      }

      .unlock-btn:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
      }

      /* Photo Album Styles from photo_album.html */
      .album-container {
        max-width: 900px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95); /* Changed from original to fit dark theme better */
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        backdrop-filter: blur(10px);
        margin-top: 80px; /* Added for spacing */
        animation: slideInFromRight 2.5s ease-out; /* Added animation */
      }

      .album-header {
        background: linear-gradient(135deg, #667eea, #764ba2); /* Changed color */
        color: white;
        padding: 30px;
        text-align: center;
      }

      .album-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .album-subtitle {
        font-size: 1.2rem;
        opacity: 0.9;
        margin-bottom: 5px;
      }

      .album-description {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .main-display {
        position: relative;
        height: 400px;
        overflow: hidden;
        background: #f8f9fa; 
      }

      .media-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .media-item.active {
        opacity: 1;
      }

      .media-item img,
      .media-item video {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        border-radius: 10px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .video-placeholder {
        width: 300px;
        height: 200px;
        background: linear-gradient(45deg, #667eea, #764ba2); /* Changed color */
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.2rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .play-button {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 60px;
        height: 60px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .play-button:hover {
        background: rgba(255, 255, 255, 1);
        transform: translate(-50%, -50%) scale(1.1);
      }

      .play-button::after {
        content: "â–¶";
        font-size: 20px;
        color: #667eea; /* Changed color */
        margin-left: 3px;
      }

      .navigation {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 10;
      }

      .nav-btn {
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: #667eea; /* Changed color */
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .nav-btn:hover {
        background: rgba(255, 255, 255, 1);
        transform: scale(1.1);
      }

      .media-counter {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        backdrop-filter: blur(10px);
      }

      .thumbnail-strip {
        padding: 20px;
        background: #f8f9fa; /* Kept light for contrast */
      }

      .thumbnails {
        display: flex;
        gap: 10px;
        overflow-x: auto;
        padding: 10px 0;
        scrollbar-width: thin;
        scrollbar-color: #667eea #f1f1f1; /* Changed color */
      }

      .thumbnails::-webkit-scrollbar {
        height: 6px;
      }

      .thumbnails::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 3px;
      }

      .thumbnails::-webkit-scrollbar-thumb {
        background: #667eea; /* Changed color */
        border-radius: 3px;
      }

      .thumbnail {
        min-width: 80px;
        height: 60px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .thumbnail img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .thumbnail.video {
        background: linear-gradient(45deg, #667eea, #764ba2); /* Changed color */
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 0.8rem;
        text-align: center;
      }

      .thumbnail.active {
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        border: 2px solid #667eea; /* Changed color */
      }

      .thumbnail:hover {
        transform: scale(1.05);
      }

      .media-info {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        color: white;
        padding: 20px;
        transform: translateY(100%);
        transition: transform 0.3s ease;
      }

      .main-display:hover .media-info {
        transform: translateY(0);
      }

      .autoplay-btn {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0.9);
        border: none;
        padding: 10px 15px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.9rem;
        color: #667eea; /* Changed color */
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .autoplay-btn:hover {
        background: rgba(255, 255, 255, 1);
      }

      .autoplay-btn.active {
        background: #667eea; /* Changed color */
        color: white;
      }

      /* Additional Animation Classes */
      .animate-on-scroll {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease-out;
      }

      .animate-on-scroll.animated {
        opacity: 1;
        transform: translateY(0);
      }

      .bounce-in {
        animation: bounceIn 1s ease-out;
      }

      @keyframes bounceIn {
        0% {
          transform: scale(0.3);
          opacity: 0;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.8;
        }
        70% {
          transform: scale(0.9);
          opacity: 0.9;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }

      .fade-in-left {
        animation: fadeInLeft 1s ease-out;
      }

      @keyframes fadeInLeft {
        0% {
          transform: translateX(-50px);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .rotate-in {
        animation: rotateIn 1s ease-out;
      }

      @keyframes rotateIn {
        0% {
          transform: rotate(-180deg) scale(0.5);
          opacity: 0;
        }
        100% {
          transform: rotate(0deg) scale(1);
          opacity: 1;
        }
      }

      /* Success message - Dark Theme with Animation */
      .success-message {
        background: linear-gradient(135deg, #48bb78, #38a169);
        color: white;
        padding: 15px;
        border-radius: 10px;
        margin: 20px 0;
        text-align: center;
        display: none;
        animation: successSlide 0.5s ease-out;
      }

      @keyframes successSlide {
        from {
          transform: translateY(-20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Music note animation - Enhanced */
      .music-note {
        position: fixed;
        font-size: 24px;
        color: rgba(255, 215, 0, 0.7);
        pointer-events: none;
        z-index: 2;
        animation: musicFloat 5s ease-in-out infinite;
      }

      @keyframes musicFloat {
        0%,
        100% {
          transform: translateY(0) rotate(0deg) scale(1);
          opacity: 0.7;
        }
        25% {
          transform: translateY(-15px) rotate(90deg) scale(1.2);
          opacity: 1;
        }
        50% {
          transform: translateY(-30px) rotate(180deg) scale(1);
          opacity: 0.8;
        }
        75% {
          transform: translateY(-15px) rotate(270deg) scale(1.1);
          opacity: 1;
        }
      }

      /* Footer - Dark Theme with Animation */
      .footer {
        text-align: center;
        margin: 60px 0 40px;
        padding: 30px;
        background: rgba(45, 55, 72, 0.8);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        border: 1px solid rgba(255, 215, 0, 0.2);
        animation: footerSlideUp 2.8s ease-out;
      }

      @keyframes footerSlideUp {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .footer-text {
        color: #e2e8f0;
        font-size: 18px;
        line-height: 1.6;
        margin-bottom: 15px;
        animation: textGlow 4s ease-in-out infinite alternate;
      }

      .contact-link {
        color: #ffd700;
        text-decoration: none;
        font-weight: 600;
        transition: all 0.3s ease;
        position: relative;
      }

      .contact-link::before {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background: #ffd700;
        transition: width 0.3s ease;
      }

      .contact-link:hover::before {
        width: 100%;
      }

      .contact-link:hover {
        color: #fff;
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      }

      .social-icons {
        margin-top: 20px;
      }

      .social-icon {
        display: inline-block;
        width: 45px;
        height: 45px;
        background: rgba(255, 215, 0, 0.2);
        color: #ffd700;
        text-align: center;
        line-height: 45px;
        border-radius: 50%;
        margin: 0 10px;
        transition: all 0.3s ease;
        text-decoration: none;
        border: 2px solid rgba(255, 215, 0, 0.3);
        animation: socialBounce 3s ease-in-out infinite;
      }

      .social-icon:nth-child(1) {
        animation-delay: 0s;
      }
      .social-icon:nth-child(2) {
        animation-delay: 0.2s;
      }
      .social-icon:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes socialBounce {
        0%,
        100% {
          transform: translateY(0);
        }
        25% {
          transform: translateY(-5px);
        }
        75% {
          transform: translateY(5px);
        }
      }

      .social-icon:hover {
        background: #ffd700;
        color: #333;
        transform: translateY(-8px) scale(1.1);
        box-shadow: 0 10px 25px rgba(255, 215, 0, 0.4);
      }

      /* Mobile Responsive with Enhanced Animations */
      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        .main-title {
          font-size: 2.8rem;
        }

        .sub-title {
          font-size: 2rem;
        }

        .countdown-grid {
          grid-template-columns: repeat(2, 1fr);
          gap: 15px;
        }

        .countdown-number {
          font-size: 2.2rem;
        }

        .actions-container {
          flex-direction: column;
          align-items: center;
        }

        .decoration {
          width: 60px;
          height: 60px;
          font-size: 18px;
        }

        .invitation-form,
        .access-form {
          padding: 30px 20px;
        }

        .audio-control {
          bottom: 20px;
          right: 20px;
          width: 50px;
          height: 50px;
          font-size: 20px;
        }

        .album-title {
          font-size: 2.8rem;
        }

        .photo-grid {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 15px;
          padding: 0 15px;
        }

        .photo-modal-content {
          max-width: 95%;
        }

        .photo-close {
          top: -50px;
          font-size: 32px;
          width: 45px;
          height: 45px;
        }

        .nav-btn {
          width: 45px;
          height: 45px;
          font-size: 18px;
        }

        .photo-caption {
          bottom: -120px;
          font-size: 14px;
          padding: 20px;
        }

        .lock-icon {
          font-size: 3rem;
        }

        .access-title {
          font-size: 26px;
        }
      }

      @media (max-width: 480px) {
        .main-title {
          font-size: 2.2rem;
        }

        .sub-title {
          font-size: 1.6rem;
        }

        .countdown-grid {
          grid-template-columns: 1fr 1fr;
          gap: 10px;
        }

        .countdown-item {
          padding: 18px 12px;
        }

        .countdown-number {
          font-size: 1.8rem;
        }

        .countdown-label {
          font-size: 13px;
        }

        .photo-grid {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .album-title {
          font-size: 2.2rem;
        }

        .photo-navigation {
          padding: 0 10px;
        }

        .lock-icon {
          font-size: 2.5rem;
        }

        .lock-message {
          font-size: 16px;
        }
      }

      /* Farewell Letter Specific Styles */
      #farewell-letter-section {
        display: none; /* Hidden by default */
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 10001; /* Above other modals */
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      }

      #farewell-letter-section.visible {
        display: flex;
        opacity: 1;
      }

      .farewell-letter-container {
        background: linear-gradient(135deg, #f0e6f6, #e0c6e6); /* Soft gradient */
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        max-width: 700px;
        width: 90%;
        max-height: 80%;
        overflow-y: auto;
        position: relative;
        font-family: "Dancing Script", cursive;
        font-size: 1.4rem;
        line-height: 1.8;
        color: #333;
        text-align: left;
        border: 2px solid #d9534f; /* Romantic red border */
        transform: scale(0.8);
        transition: transform 0.5s ease-out;
      }

      #farewell-letter-section.visible .farewell-letter-container {
        transform: scale(1);
      }

      .farewell-letter-container h2 {
        font-family: "Dancing Script", cursive;
        font-size: 2.8rem;
        color: #d9534f;
        text-align: center;
        margin-bottom: 25px;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      }

      .farewell-letter-content {
        white-space: pre-wrap;
        min-height: 100px; /* Ensure space for typing */
      }

      .farewell-close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 2.5rem;
        color: #d9534f;
        cursor: pointer;
        font-weight: bold;
        line-height: 1;
        transition: color 0.3s ease;
      }

      .farewell-close-btn:hover {
        color: #a94442;
      }

      /* Envelope for the farewell letter */
      .farewell-envelope-wrapper {
        display: none; /* Hidden until countdown ends */
        position: relative;
        width: 280px;
        height: 180px;
        margin: 50px auto; /* Center it */
        cursor: pointer;
        z-index: 1000; /* Ensure it's above other content */
        opacity: 0;
        transition: opacity 1s ease-in-out;
      }

      .farewell-envelope-wrapper.visible {
        display: block;
        opacity: 1;
      }

      .farewell-envelope {
        position: relative;
        width: 280px;
        height: 180px;
        border-bottom-left-radius: 6px;
        border-bottom-right-radius: 6px;
        background-color: #d9534f; /* Warm romantic red */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      .farewell-envelope .front {
        position: absolute;
        width: 0;
        height: 0;
        z-index: 3;
      }

      .farewell-envelope .flap {
        border-left: 140px solid transparent;
        border-right: 140px solid transparent;
        border-bottom: 82px solid transparent;
        border-top: 98px solid #d9534f; /* Same romantic red */
        transform-origin: top;
        pointer-events: none;
      }

      .farewell-envelope .pocket {
        border-left: 140px solid #f5a3a2; /* Soft pinkish red for the pocket */
        border-right: 140px solid #f5a3a2;
        border-bottom: 90px solid #ff6f61; /* Lighter romantic red */
        border-top: 90px solid transparent;
        border-bottom-left-radius: 6px;
        border-bottom-right-radius: 6px;
      }

      .farewell-envelope .letter-preview {
        position: relative;
        background-color: #fff;
        width: 90%;
        margin-left: auto;
        margin-right: auto;
        height: 90%;
        top: 5%;
        border-radius: 6px;
        box-shadow: 0 2px 26px rgba(0, 0, 0, 0.12);
        font-family: "Dancing Script", cursive;
        padding: 10px;
        font-size: 0.9rem;
        color: #555;
        overflow: hidden;
      }

      .farewell-envelope .letter-preview p {
        margin: 0;
        line-height: 1.2;
      }

      .farewell-envelope .hearts {
        position: absolute;
        top: 90px;
        left: 0;
        right: 0;
        z-index: 2;
      }

      .farewell-envelope .heart {
        position: absolute;
        bottom: 0;
        right: 10%;
        pointer-events: none;
      }

      .farewell-envelope .heart:before,
      .farewell-envelope .heart:after {
        position: absolute;
        content: "";
        left: 50px;
        top: 0;
        width: 50px;
        height: 80px;
        background: #e60073; /* Deep romantic pink */
        border-radius: 50px 50px 0 0;
        transform: rotate(-45deg);
        transform-origin: 0 100%;
        pointer-events: none;
      }

      .farewell-envelope .heart:after {
        left: 0;
        transform: rotate(45deg);
        transform-origin: 100% 100%;
      }

      .farewell-envelope.open .flap {
        transform: rotateX(180deg);
        transition: transform 0.4s ease, z-index 0.6s;
        z-index: 1;
      }

      .farewell-envelope.close .flap {
        transform: rotateX(0deg);
        transition: transform 0.4s 0.6s ease, z-index 1s;
        z-index: 5;
      }

      .farewell-envelope.close .letter-preview {
        transform: translateY(0px);
        transition: transform 0.4s ease, z-index 1s;
        z-index: 1;
      }

      .farewell-envelope.open .letter-preview {
        transform: translateY(-100px);
        transition: transform 0.4s 0.6s ease, z-index 0.6s;
        z-index: 2;
      }

      .farewell-envelope.close .heart {
        opacity: 0;
        -webkit-animation: none;
        animation: none;
      }




      /* Container for book and controls */
      .flipbook-container {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        min-height: 0;
      }

      /* FlipBook Structure */
      .book {
        position: relative;
        display: flex;
        width: 10rem; /* Explicitly set width to 15rem */
        height: 15rem; /* Retained height from previous instruction */
       
        pointer-events: none;
        transform-style: preserve-3d;
        transition: translate 1s;
        translate: calc(min(var(--c), 1) * 50%) 0%;
        rotate: 1 0 0 30deg;
      }

      .page {
        --thickness: 4;
        flex: none;
        display: flex;
        width: 100%;
        height: 100%;
        font-size: clamp(8px, 1.5vmin, 16px);
        pointer-events: all;
        user-select: none;
        transform-style: preserve-3d;
        transform-origin: left center;
        transition: transform 1s,
          rotate 1s ease-in
            calc(
              (min(var(--i), var(--c)) - max(var(--i), var(--c))) * 50ms
            );
        translate: calc(var(--i) * -100%) 0px 0px;
        transform: translateZ(
          calc(
            (var(--c) - var(--i) - 0.5) * calc(var(--thickness) * 0.23vmin)
          )
        );
        rotate: 0 1 0 calc(clamp(0, var(--c) - var(--i), 1) * -180deg);
        box-shadow: 0em 0.5em 1em -0.2em #00000020;
      }

      .front,
      .back {
        position: relative;
        flex: none;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        overflow: hidden;
        background-color: #fff;
        translate: 0px;
        display: flex;
        flex-flow: column wrap;
        justify-content: space-between;
        padding: 1.5em;
        border: 1px solid #0002;
      }

      .back {
        translate: -100% 0;
        rotate: 0 1 0 180deg;
      }

      /* FlipBook Customization */
      .book {
        counter-reset: page -1;
        & a {
          color: inherit;
        }
      }

      .front:has(img),
      .back:has(img) {
        padding: 0;
      }

      .front img,
      .back img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .front::after,
      .back::after {
        position: absolute;
        bottom: 1em;
        counter-increment: page;
        content: counter(page) ".";
        font-size: 0.8em;
      }

      .cover::after {
        content: "";
      }

      .front {
        &::after {
          right: 1em;
        }
        background: linear-gradient(to left, #f7f7f7 80%, #eee 100%);
        border-radius: 0.1em 0.5em 0.5em 0.1em;
      }

      .back {
        &::after {
          left: 1em;
        }
        background-image: linear-gradient(to right, #f7f7f7 80%, #eee 100%);
        border-radius: 0.5em 0.1em 0.1em 0.5em;
      }

      .cover {
        background: radial-gradient(
            circle farthest-corner at 80% 20%,
            hsl(150 80% 20% / 0.3) 0%,
            hsl(170 60% 10% / 0.1) 100%
          ),
          hsl(231, 32%, 29%) url("https://picsum.photos/id/984/800/900") 50% /
            cover;
        color: hsl(200 30% 98%);
      }

      /* Content specific styles for image collage - Front page */
      .content {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: auto repeat(2, 1fr);
        height: 100%;
        width: 100%;
        padding: 0.5em;
        box-sizing: border-box;
        gap: 0.5em;
      }

      /* Content specific styles for back page */
      .content-back {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: auto repeat(2, 1fr) auto;
        height: 100%;
        width: 100%;
        padding: 0.5em;
        box-sizing: border-box;
        gap: 0.5em;
      }

      .content__title {
        grid-row: 1;
        grid-column: 1/4;
        font-family: "Cute Font", cursive;
        font-size: 1.8em;
        line-height: 1;
        padding: 0.3em;
        box-sizing: border-box;
        color: #333;
        text-align: center;
      }

      .content__img-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        border: 3px solid #eee;
        cursor: pointer;
        transition: transform 0.2s ease-in-out;
        position: relative;
      }

      .content__img-wrapper:hover {
        transform: scale(1.02);
      }

      .content__img-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      /* Front page image positions */
      .content__img1 {
        grid-row: 2;
        grid-column: 1/3;
      }

      .content__img2 {
        grid-row: 2;
        grid-column: 3;
      }

      .content__img3 {
        grid-row: 3;
        grid-column: 1;
      }

      .content__img4 {
        grid-row: 3;
        grid-column: 2/4;
      }

      /* Back page image positions */
      .content-back .content__img5 {
        grid-row: 2;
        grid-column: 1/3;
      }

      .content-back .content__img6 {
        grid-row: 3;
        grid-column: 1;
      }

      .content-back .content__img7 {
        grid-row: 3;
        grid-column: 2;
      }

      .content__text {
        grid-column: 1/4;
        padding: 0.5em;
        font-size: 0.9em;
        box-sizing: border-box;
        color: #333;
        text-align: center;
      }

      .content-back .content__text {
        grid-column: 1/3;
        grid-row: 4;
      }

      /* Navigation Controls */
      .navigation-controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        margin: 10px auto;
        max-width: 400px;
      }

      .nav-button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 8px 16px; /* Decreased padding */
        border-radius: 25px;
        cursor: pointer;
        font-family: "Poppins", sans-serif;
        font-size: 12px; /* Decreased font size */
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        min-width: 90px; /* Decreased minimum width */
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .nav-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
      }

      .nav-button:active {
        transform: translateY(0);
      }

      .nav-button:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .page-indicator {
        background: rgba(255, 255, 255, 0.9);
        color: #333;
        padding: 8px 16px;
        border-radius: 15px;
        font-family: "Poppins", sans-serif;
        font-size: 14px;
        font-weight: 600;
        min-width: 80px;
        text-align: center;
      }

      /* Image Zoom Overlay */
      .zoom-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        cursor: zoom-out;
      }

      .zoom-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .zoom-overlay img {
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        border: 5px solid #fff;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        transform: scale(0.8);
        transition: transform 0.3s ease-in-out;
      }

      .zoom-overlay.active img {
        transform: scale(1);
      }

      /* Curtain Styles from welcome.html */
      .rnOuter {
          position: relative;
          height: 100vh;
          width: 100%;
      }
      
      .rnInner, .rnInnerRight {
          background: #ae1313;
          width: 100%;
          position: absolute;
          top: -10%; /* Adjusted to cover the whole screen */
          right: 0;
          bottom: 0;
          left: 0;
          margin: auto;
          transform-style: preserve-3d;
          transition: transform 4s ease-in-out;
      }
      
      .rnInner {
          transform-origin: -120% top;
      }
      
      .rnInnerRight {
          transform-origin: 120% top;
      }
      
      .rnUnit {
          width: 10vw;
          height: 120vh;
          background: repeating-linear-gradient(to left, #e51919 4vw, #890f0f 8vw, #ef7575 10vw);
          background-size: 100% 100%;
          display: inline-block;
          transform-origin: 0 0%;
          transform: rotate(3deg);
          animation: 2s infinite rnUnit;
      }
      
      @keyframes rnUnit {
          50% {
              transform: rotate(-3deg);
          }
      }
      
      .rnUnit:nth-child(1) { animation-delay: -0.1s; }
      .rnUnit:nth-child(2) { animation-delay: -0.2s; }
      .rnUnit:nth-child(3) { animation-delay: -0.3s; }
      .rnUnit:nth-child(4) { animation-delay: -0.4s; }
      .rnUnit:nth-child(5) { animation-delay: -0.5s; }
      .rnUnit:nth-child(6) { animation-delay: -0.6s; }
      .rnUnit:nth-child(7) { animation-delay: -0.7s; }
      .rnUnit:nth-child(8) { animation-delay: -0.8s; }
      .rnUnit:nth-child(9) { animation-delay: -0.9s; }
      .rnUnit:nth-child(10) { animation-delay: -1s; }
      
      .rxWorld:hover .rnInner.open {
          transform-origin: -120% top;
          transform: scaleX(0);
      }
      
      .rxWorld:hover .rnInnerRight.open {
          transform-origin: 120% top;
          transform: scaleX(0);
      }
      
      .rxWorld #curtain {
          display: flex;
          position: absolute;
          top: 0; /* Ensure it covers the whole screen */
          width: 100vw;
          height: 100vh; /* Ensure it covers the whole screen */
          z-index: 10001; /* Above loader */
          cursor: pointer;
      }
      
    </style>
  </head>
  <body>
    <!-- Loader -->
    <div class="loader-container" id="loader">
      <div class="loader">
        <div class="loader-animation">
          <div class="loader-ring"></div>
          <div class="loader-ring"></div>
          <div class="loader-ring"></div>
          <div class="loader-center">
            <i class="fas fa-heart"></i>
          </div>
        </div>
        <div class="loader-text">Loading Your Invitation...</div>
      </div>
    </div>

    <!-- Curtain from welcome.html -->
    <div id="curtain" class="rxWorld" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 10001;">
        <section class="rnOuter">
            <div class="rnInner">
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
            </div>
            <div class="rnInnerRight">
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
                <div class="rnUnit"></div>
            </div>
        </section>
    </div>

    <!-- Audio Control Button (Initially hidden, will be removed by JS on first interaction) -->
    <button class="audio-control" id="audioControl" style="display: none">
      <i class="fas fa-play" id="audioIcon"></i>
    </button>

    <!-- Album Access Modal -->
    <div class="album-access-modal" id="albumAccessModal">
      <div class="access-form">
        <h2 class="access-title">ðŸ”’ Album Access</h2>
        <p class="access-description">
          This photo album contains special memories. Please enter the access code to view.
        </p>
        <input type="text" class="access-input" id="albumCode" placeholder="Enter Code" maxlength="6" />
        <div class="error-message" id="albumErrorMessage">Invalid access code. Please try again.</div>
        <div style="margin-top: 25px">
          <button class="access-button" onclick="verifyAlbumAccess()">
            <i class="fas fa-unlock"></i> Unlock Album
          </button>
          <button class="access-button secondary" onclick="closeAlbumModal()">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Invitation Form Modal -->
    <div class="modal-overlay" id="invitationModal">
      <div class="invitation-form">
        <h2 class="form-title">Personal Invitation</h2>
        <p style="color: #a0aec0; margin-bottom: 20px">
          Enter your details to download your personalized invitation
        </p>
        <input type="text" class="form-input" id="guestName" placeholder="Enter your full name" maxlength="50" />
        <input type="text" class="form-input" id="guestCode" placeholder="Enter 4-digit code" maxlength="4" pattern="[0-9]{4}" />
        <div class="success-message" id="successMessage">Invitation downloaded successfully!</div>
        <div style="margin-top: 20px">
          <button class="form-button" onclick="downloadInvitation()">Download Invitation</button>
          <button class="form-button secondary" onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
      <!-- Particles Background -->
      <div class="particles" id="particles"></div>

      <!-- Music Notes -->
      <div class="music-notes"></div>

      <!-- Decorations -->
      <div class="decoration top-right-decoration rotate-in">
        <img src="https://raw.githubusercontent.com/CodeCr4cker/Farewell-invitation-card/main/assets/img/right.png" alt="Right Decoration">
      </div>
      <div class="decoration top-left-decoration bounce-in">
        <img src="https://raw.githubusercontent.com/CodeCr4cker/Farewell-invitation-card/main/assets/img/left.png" alt="Left Decoration">
      </div>

      <div class="container">
        <!-- Title Section -->
        <div class="title-section animate-on-scroll">
          <h1 class="main-title">Farewell</h1>
          <h2 class="sub-title">Celebration</h2>
          <div class="event-details">
            <p>Join us for an unforgettable evening on <span class="highlight">28 December 2025</span></p>
            <p>at <span class="highlight">Ashirwad Garden</span>, Ratu, Ranchi</p>
            <p style="font-style: italic; margin-top: 15px">Dinner & Dancing to Follow</p>
            <p style="font-size: 16px; color: #a0aec0; margin-top: 10px;">
              Organized by the students of Class 12th, Session 2025-26, of BL Academy.
            </p>
          </div>
        </div>
        <!-- Farewell Letter Envelope (Hidden until countdown ends) -->
        <div class="farewell-envelope-wrapper" id="farewellEnvelopeWrapper">
          <div class="farewell-envelope close" id="farewellEnvelope">
            <div class="front flap"></div>
            <div class="front pocket"></div>
            <div class="letter-preview">
              <p>A special message awaits you...</p>
              <p style="font-size: 0.7em; margin-top: 5px;">Click to open!</p>
            </div>
            <div class="hearts">
              <div class="heart a1"></div>
              <div class="heart a2"></div>
              <div class="heart a3"></div>
            </div>
          </div>
        </div>
        <!-- Countdown Timer -->
        <div class="countdown-container animate-on-scroll">
          <div class="countdown">
            <div class="countdown-title">Time Until Celebration</div>
            <div class="countdown-grid" id="countdown">
              <!-- Countdown will be populated by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="actions-container animate-on-scroll">
          <a href="#" class="action-btn invitation-btn" onclick="openInvitationModal()">
            <i class="fas fa-download"></i>
            Get Personal Invitation
          </a>
          <a href="#photo-album-section" class="action-btn" onclick="scrollToPhotoAlbum()">
            <i class="fas fa-images"></i>
            View Photo Album
          </a>
          <a href="https://goo.gl/maps/5z5xX2hTYzU8VGEJ9" target="_blank" class="action-btn">
            <i class="fas fa-map-marker-alt"></i>
            View Venue
          </a>
          <a
            href="https://raw.githubusercontent.com/CodeCr4cker/Farewell-invitation-card/main/assets/Invitation/farewell%20.pdf"
            class="action-btn"
            download>
            <i class="fas fa-file-pdf"></i>
            Download General Invite
          </a>
        </div>



        <!-- Photo Album Section (New Album) -->
        <div class="photo-album-section animate-on-scroll" id="photo-album-section">
          <div class="album-lock-overlay" id="albumLockOverlay">
            <div class="lock-icon">
              <i class="fas fa-lock"></i>
            </div>
            <div class="lock-message">
              This album contains precious memories<br />
              Enter the access code to unlock
            </div>
            <button class="unlock-btn" onclick="openAlbumAccessModal()">
              <i class="fas fa-key"></i> Enter Access Code
            </button>
          </div>

          <div class="album-container">
            <div class="album-header">
              <h1 class="album-title">The Art of Memories</h1>
              <p class="album-subtitle">Explore the stories within each moment</p>
              <p class="album-description">Every memory is a chapter in your life's narrative</p>
            </div>

            <div class="main-display" id="mainDisplay">
              <!-- <button class="autoplay-btn" id="autoplayBtn">â–¶ Auto Play</button> -->
              <div class="media-counter" id="mediaCounter">1 / 20</div>

              <!-- ADDED NAVIGATION BUTTONS HERE -->
              <div class="navigation">
                <button class="nav-btn" id="prevBtn"><i class="fas fa-chevron-left"></i></button>
                <button class="nav-btn" id="nextBtn"><i class="fas fa-chevron-right"></i></button>
              </div>
              <!-- Media items will be dynamically loaded here by PhotoAlbum class -->
            </div>

            <div class="thumbnail-strip">
              <div class="thumbnails" id="thumbnails">
                <!-- Thumbnails will be dynamically loaded here by PhotoAlbum class -->
              </div>
            </div>
          </div>
        </div>
    <div id="app">
      <div class="flipbook-container">
        <div class="book" ref="book">
          <!-- First Cover Page -->
          <div class="page">
            <div class="front cover">
              <h1>Farewell</h1>
              <p>2025.<br />BL Academy</p>
            </div>
            <div class="back">
              <h2></h2>
            </div>
          </div>

          <!-- Dynamic Pages with Image Collages -->
          <div class="page" v-for="(page, idx) in items" :key="idx + 1">
            <div class="front">
              <div class="content">
                <div class="content__title">{{ page.title }}</div>
                <div
                  class="content__img-wrapper content__img1"
                  v-if="page.img1"
                  @click="zoomImage(page.img1)"
                >
                  <img :src="page.img1" />
                </div>
                <div
                  class="content__img-wrapper content__img2"
                  v-if="page.img2"
                  @click="zoomImage(page.img2)"
                >
                  <img :src="page.img2" />
                </div>
                <div
                  class="content__img-wrapper content__img3"
                  v-if="page.img3"
                  @click="zoomImage(page.img3)"
                >
                  <img :src="page.img3" />
                </div>
                <div
                  class="content__img-wrapper content__img4"
                  v-if="page.img4"
                  @click="zoomImage(page.img4)"
                >
                  <img :src="page.img4" />
                </div>
              </div>
            </div>
            <div class="back">
              <div class="content-back">
                <div
                  class="content__img-wrapper content__img5"
                  v-if="page.img5"
                  @click="zoomImage(page.img5)"
                >
                  <img :src="page.img5" />
                </div>
                <div
                  class="content__img-wrapper content__img6"
                  v-if="page.img6"
                  @click="zoomImage(page.img6)"
                >
                  <img :src="page.img6" />
                </div>
                <div
                  class="content__img-wrapper content__img7"
                  v-if="page.img7"
                  @click="zoomImage(page.img7)"
                >
                  <img :src="page.img7" />
                </div>
                <div class="content__text" v-if="page.textBack">
                  {{ page.textBack }}
                </div>
              </div>
            </div>
          </div>

          <!-- Last Cover Page -->
          <div class="page">
            <div class="front">
              <img src="https://picsum.photos/id/1073/600/600" alt="Img 2" />
            </div>
            <div class="back cover"></div>
          </div>
        </div>
      </div>

      <!-- Navigation Controls -->
      <div class="navigation-controls">
        <button 
          class="nav-button" 
          @click="previousPage" 
          :disabled="currentPage === 0"
        >
          â† Previous
        </button>
        
        <div class="page-indicator">
          {{ currentPage + 1 }} / {{ totalPages }}
        </div>
        
        <button 
          class="nav-button" 
          @click="nextPage" 
          :disabled="currentPage === totalPages - 1"
        >
          Next â†’
        </button>
      </div>

      <!-- Image Zoom Overlay -->
      <div
        class="zoom-overlay"
        :class="{ 'active': zoomedImage }"
        @click="closeZoom"
        v-if="zoomedImage"
      >
        <img :src="zoomedImage" @click.stop />
      </div>
    </div>
        <!-- Footer -->
        <div class="footer animate-on-scroll">
          <p class="footer-text">
            Can't wait to make this farewell a memorable moment with you!<br />
            Just a ping away for any queries:
            <a href="https://its-divyanshu.netlify.app/" class="contact-link">Contact Me</a>
          </p>
          <p style="color: #a0aec0; margin-top: 20px; font-size: 16px">Join us in our happiness! ðŸ’«</p>
          <p style="color: #a0aec0; margin-top: 20px; font-size: 16px">Â© Divyanshu Pandey</p>
        </div>
      </div>

      <!-- Hidden audio element -->
      <audio id="backgroundMusic" loop preload="auto">
        <source src="https://raw.githubusercontent.com/CodeCr4cker/Web-Storage/main/Farewell-invitation-card/audio/song.mp3" type="audio/mpeg" />
      </audio>

      <!-- New audio element for flipbook -->
      <audio id="flipbookMusic" loop preload="auto">
        <source src="https://raw.githubusercontent.com/CodeCr4cker/Web-Storage/main/Farewell-invitation-card/audio/album.mp3" type="audio/mpeg" />
      </audio>
    </div>




    <!-- Full-screen Farewell Letter Display -->
    <div id="farewell-letter-section">
      <div class="farewell-letter-container">
        <button class="farewell-close-btn" id="farewellCloseBtn">X</button>
        <h2>A Special Farewell Message</h2>
        <p class="farewell-letter-content" id="farewellLetterContent"></p>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
      let albumUnlocked = false; // Album access status
      const ALBUM_ACCESS_CODE = "12BL25"; // Access code for album

      // Guest database for invitation downloads
      const guestDatabase = {
        "1234": { name: "Divyanshu", photo: "https://raw.githubusercontent.com/CodeCr4cker/Farewell-invitation-card/main/assets/img/cover.jpg" },
        "5678": { name: "Jane Smith", photo: "https://via.placeholder.com/400x600/764ba2/ffffff?text=Jane+Smith+Invitation" },
        "9999": { name: "Guest User", photo: "https://via.placeholder.com/400x600/ffd700/333333?text=Special+Guest+Invitation" },
      };

      // Audio control variables
      let audio = null; // Main background music
      let flipbookAudio = null; // Flipbook specific music
      let isPlaying = false; // Is main background music playing
      let isFlipbookMusicPlaying = false; // Is flipbook music playing
      let audioInitialized = false; // New flag to track if main audio has been initialized
      let isVideoPlaying = false; // New flag to track if a video is playing
      let photoAlbumInstance = null; // Declare a global variable for PhotoAlbum instance

      // Farewell Letter Variables
      let farewellTypingInterval;
      let farewellCharIndex = 0;
      const fullFarewellContent = `Dear Friends,

It's hard to say goodbye, but every ending is a new beginning.

I want to thank you for all the memories we've shared. Each moment, whether joyful or challenging, has contributed to who I am today.

As we embark on different paths, I wish you nothing but the best in all your future endeavors. May your journey be filled with success, happiness, and new discoveries.

Remember the good times, and know that you will always hold a special place in my heart.

With heartfelt wishes.`;

      // Album Access Functions
      function openAlbumAccessModal() {
        document.getElementById("albumAccessModal").classList.add("active");
        document.getElementById("albumCode").focus();
      }

      function closeAlbumModal() {
        document.getElementById("albumAccessModal").classList.remove("active");
        document.getElementById("albumErrorMessage").style.display = "none";
        document.getElementById("albumCode").value = "";
      }

      function verifyAlbumAccess() {
        const code = document.getElementById("albumCode").value.trim().toUpperCase();
        const errorMessage = document.getElementById("albumErrorMessage");

        if (code === ALBUM_ACCESS_CODE) {
          albumUnlocked = true;
          closeAlbumModal();
          unlockAlbum();
          showSuccessAnimation();
        } else {
          errorMessage.style.display = "block";
          document.getElementById("albumCode").value = "";
          document.getElementById("albumCode").focus();

          // Add shake animation to form
          const form = document.querySelector(".access-form");
          form.style.animation = "shake 0.5s ease-in-out";
          setTimeout(() => {
            form.style.animation = "";
          }, 500);
        }
      }

      function unlockAlbum() {
        const albumSection = document.getElementById("photo-album-section");
        const lockOverlay = document.getElementById("albumLockOverlay");
        const albumContainer = albumSection.querySelector(".album-container"); // Get the album container

        // Remove lock overlay with animation
        lockOverlay.style.opacity = "0";
        lockOverlay.style.transform = "scale(0.8)";

        setTimeout(() => {
          lockOverlay.style.display = "none";
          albumSection.classList.remove("locked");
          if (albumContainer) {
            albumContainer.style.display = "block"; // Show the album container
          }
          // The PhotoAlbum class will handle its own initialization
          // No need to call initializePhotoAlbum() here as the class constructor does it

          // Add unlock animation
          albumSection.style.animation = "bounceIn 1s ease-out";
        }, 500);
      }

      function showSuccessAnimation() {
        // Create success notification
        const notification = document.createElement("div");
        notification.innerHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                     background: linear-gradient(135deg, #48bb78, #38a169); color: white;
                     padding: 20px 30px; border-radius: 15px; font-size: 18px; font-weight: 600;
                     z-index: 10002; box-shadow: 0 15px 35px rgba(0,0,0,0.3); animation: successPop 0.6s ease-out;">
                    <i class="fas fa-unlock" style="margin-right: 10px;"></i>
                    Album Unlocked Successfully!
                </div>
            `;

        document.body.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, 2500);
      }

      function scrollToPhotoAlbum() {
        document.getElementById("photo-album-section").scrollIntoView({
          behavior: "smooth",
          block: "start",
        });

        // If album is locked, automatically open access modal after scroll
        if (!albumUnlocked) {
          setTimeout(() => {
            openAlbumAccessModal();
          }, 800);
        }
      }

      // Enhanced Animation Observer
      function setupScrollAnimations() {
        const observerOptions = {
          threshold: 0.1,
          rootMargin: "0px 0px -50px 0px",
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("animated");
            }
          });
        }, observerOptions);

        // Observe all elements with animate-on-scroll class
        document.querySelectorAll(".animate-on-scroll").forEach((el) => {
          observer.observe(el);
        });
      }

      // Loader functionality with enhanced animation
      window.addEventListener("load", function () {
        setTimeout(() => {
          document.getElementById("loader").style.opacity = "0";
          setTimeout(() => {
            document.getElementById("loader").style.display = "none";
            // Show the curtain after the loader is gone
            const curtain = document.getElementById("curtain");
            if (curtain) {
              curtain.style.display = "flex"; // Make the curtain visible
            }
            // Main content remains hidden until curtain opens
            // document.getElementById("mainContent").style.opacity = "1"; // This will be handled after curtain
            // startAnimations(); // This will be called after curtain opens
            // setupScrollAnimations(); // This will be called after curtain opens
          }, 500);
        }, 2000);
      });

      // Initialize audio on first user interaction
      function initAudioOnInteraction() {
        if (audioInitialized) return; // Only run once

        // audio is already initialized in DOMContentLoaded
        const audioControl = document.getElementById("audioControl");
        const audioIcon = document.getElementById("audioIcon");

        audio
          .play()
          .then(() => {
            isPlaying = true;
            audioInitialized = true;
            // Remove the audio control button after successful playback
            if (audioControl) audioControl.remove();
            createMusicNotes(); // Start music notes animation only when playing
          })
          .catch((error) => {
            console.log("Audio play failed on interaction:", error);
            // If autoplay fails, show the button for manual control
            if (audioControl) audioControl.style.display = "flex";
          });
      }

      // Attach a global click listener to trigger audio playback
      // document.addEventListener("click", initAudioOnInteraction, { once: true }); // Removed, now triggered by curtain
      // document.addEventListener("keydown", initAudioOnInteraction, { once: true }); // Removed, now triggered by curtain

      // Start animations after loader
      function startAnimations() {
        createParticles();
        startCountdown();
        // Initially hide the album content until unlocked
        const albumSection = document.getElementById("photo-album-section");
        if (albumSection) {
          albumSection.classList.add("locked");
          const albumContainer = albumSection.querySelector(".album-container");
          if (albumContainer) {
            albumContainer.style.display = "none"; // Ensure it's hidden from the start
          }
        }
      }

      // Create floating particles with enhanced animation
      function createParticles() {
        const particlesContainer = document.getElementById("particles");
        for (let i = 0; i < 60; i++) {
          const particle = document.createElement("div");
          particle.className = "particle";
          particle.style.left = Math.random() * 100 + "%";
          particle.style.top = Math.random() * 100 + "%";
          particle.style.animationDelay = Math.random() * 6 + "s";
          particle.style.animationDuration = Math.random() * 4 + 4 + "s";

          // Random colors
          const colors = ["rgba(255, 215, 0, 0.6)", "rgba(255, 107, 107, 0.6)", "rgba(78, 205, 196, 0.6)"];
          particle.style.background = colors[Math.floor(Math.random() * colors.length)];

          particlesContainer.appendChild(particle);
        }
      }

      // Create floating music notes with enhanced animation
      function createMusicNotes() {
        const notes = ["â™ª", "â™«", "â™¬", "â™©", "ðŸŽµ", "ðŸŽ¶"];

        setInterval(() => {
          if (isPlaying && !isVideoPlaying && !isFlipbookMusicPlaying) {
            // Only show notes if main music is playing and no video/flipbook music is active
            const note = document.createElement("div");
            note.className = "music-note";
            note.innerHTML = notes[Math.floor(Math.random() * notes.length)];
            note.style.left = Math.random() * 100 + "%";
            note.style.top = "100%";
            note.style.fontSize = Math.random() * 12 + 16 + "px";
            document.body.appendChild(note);

            setTimeout(() => {
              note.remove();
            }, 5000);
          }
        }, 1500);
      }

      // Enhanced Countdown Timer
      function startCountdown() {
        const countDownDate = new Date("dec 28, 2025 15:00:00").getTime(); // Set your farewell date and time here (UPDATED TO 2024)
        const countdownContainer = document.querySelector(".countdown-container"); // Get the countdown container

        const timer = setInterval(function () {
          const now = new Date().getTime();
          const distance = countDownDate - now;

          const days = Math.floor(distance / (1000 * 60 * 60 * 24));
          const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          const seconds = Math.floor((distance % (1000 * 60)) / 1000);

          document.getElementById("countdown").innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-number">${days.toString().padStart(2, "0")}</span>
                        <span class="countdown-label">Days</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${hours.toString().padStart(2, "0")}</span>
                        <span class="countdown-label">Hours</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${minutes.toString().padStart(2, "0")}</span>
                        <span class="countdown-label">Minutes</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-number">${seconds.toString().padStart(2, "0")}</span>
                        <span class="countdown-label">Seconds</span>
                    </div>
                `;

          if (distance < 0) {
            clearInterval(timer);
            // Hide the countdown container
            countdownContainer.style.display = 'none';
            showFarewellLetterEnvelope(); // Show the farewell letter envelope when countdown ends
          }
        }, 1000);
      }

      // Modal functions
      function openInvitationModal() {
        document.getElementById("invitationModal").classList.add("active");
      }

      function closeModal() {
        document.getElementById("invitationModal").classList.remove("active");
        document.getElementById("successMessage").style.display = "none";
        document.getElementById("guestName").value = "";
        document.getElementById("guestCode").value = "";
      }

      // Download invitation function
      function downloadInvitation() {
        const name = document.getElementById("guestName").value.trim();
        const code = document.getElementById("guestCode").value.trim();

        if (!name || !code) {
          alert("Please enter both name and code");
          return;
        }

        if (code.length !== 4 || !/^\d{4}$/.test(code)) {
          alert("Please enter a valid 4-digit code");
          return;
        }

        const guest = guestDatabase[code];
        if (!guest) {
          alert("Invalid code. Please check your invitation code.");
          return;
        }

        const inputNameLower = name.toLowerCase().replace(/\s+/g, " ");
        const dbNameLower = guest.name.toLowerCase().replace(/\s+/g, " ");

        if (!inputNameLower.includes(dbNameLower.split(" ")[0]) && !dbNameLower.includes(inputNameLower.split(" ")[0])) {
          alert("Name does not match the invitation code.");
          return;
        }

        document.getElementById("successMessage").style.display = "block";

        setTimeout(() => {
          createPersonalizedInvitation(name, code, guest.photo);
        }, 1000);
      }

      // Create personalized invitation
      function createPersonalizedInvitation(name, code, photoUrl) {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = 800;
        canvas.height = 1200;

        // Dark theme background gradient
        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, "#1a1a2e");
        gradient.addColorStop(0.5, "#16213e");
        gradient.addColorStop(1, "#0f3460");
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Add decorative border
        ctx.strokeStyle = "#ffd700";
        ctx.lineWidth = 8;
        ctx.strokeRect(40, 40, canvas.width - 80, canvas.height - 80);

        // Inner border
        ctx.strokeStyle = "#ff6b6b";
        ctx.lineWidth = 2;
        ctx.strokeRect(60, 60, canvas.width - 120, canvas.height - 120);

        // Title
        ctx.fillStyle = "#ffd700";
        ctx.font = "bold 48px Arial";
        ctx.textAlign = "center";
        ctx.fillText("Farewell Celebration", canvas.width / 2, 150);

        // Guest name
        ctx.font = "bold 36px Arial";
        ctx.fillStyle = "#ff6b6b";
        ctx.fillText(`Dear ${name}`, canvas.width / 2, 220);

        // Event details
        ctx.font = "24px Arial";
        ctx.fillStyle = "#e2e8f0";
        ctx.fillText("You are cordially invited to join us", canvas.width / 2, 300);
        ctx.fillText("29 November 2025", canvas.width / 2, 350);
        ctx.fillText("Ashirwad Garden, Ratu, Ranchi", canvas.width / 2, 390);

        // Guest code
        ctx.font = "20px Arial";
        ctx.fillStyle = "#ffd700";
        ctx.fillText(`Invitation Code: ${code}`, canvas.width / 2, 450);

        // Additional details
        ctx.font = "18px Arial";
        ctx.fillStyle = "#e2e8f0";
        ctx.fillText("Dinner & Dancing to Follow", canvas.width / 2, 520);
        ctx.fillText("Dress Code: Semi-Formal", canvas.width / 2, 550);

        // Decorative elements
        ctx.fillStyle = "#ffd700";
        ctx.font = "30px Arial";
        ctx.fillText("âœ¨ ðŸ’« âœ¨", canvas.width / 2, 600);

        // Footer
        ctx.font = "16px Arial";
        ctx.fillStyle = "#a0aec0";
        ctx.fillText("Looking forward to celebrating with you!", canvas.width / 2, 700);
        ctx.fillText("Can't wait to make memorable moments together", canvas.width / 2, 730);

        // Convert to blob and download
        canvas.toBlob(function (blob) {
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `Farewell_Invitation_${name.replace(/\s+/g, "_")}_${code}.png`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);

          setTimeout(closeModal, 2000);
        });
      }

      // Photo Album Class from photo_album.html
      class PhotoAlbum {
        constructor(audioElement) {
          // Accept audioElement as a parameter
          this.currentIndex = 0;
          this.autoplayInterval = null;
          this.isAutoplay = false;
          this.currentVideo = null;
          this.backgroundAudio = audioElement; // Store the background audio element

          this.mediaData = this.generateMediaData();

          this.init();
        }

        generateMediaData() {
          const photos = [
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&h=600&fit=crop",
              title: "Mountain Serenity",
              desc: "A peaceful moment captured in nature's embrace",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",
              title: "Ocean Waves",
              desc: "The endless dance of water and sky",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&h=600&fit=crop",
              title: "Forest Path",
              desc: "Where adventure begins",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=800&h=600&fit=crop",
              title: "Golden Hour",
              desc: "When the world glows with magic",
            },
            // {
            //   type: "video",
            //   url: "https://www.w3schools.com/html/mov_bbb.mp4",
            //   title: "Summer Memories",
            //   desc: "A compilation of sunny days",
            // }, // Added video URL
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=800&h=600&fit=crop",
              title: "Desert Dreams",
              desc: "Vast landscapes and endless possibilities",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=800&h=600&fit=crop",
              title: "Urban Lights",
              desc: "City life in motion",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1501594907352-04cda38ebc=29?w=800&h=600&fit=crop",
              title: "Lake Reflection",
              desc: "Mirror of tranquility",
            },
            // {
            //   type: "video",
            //   url: "https://www.w3schools.com/html/movie.mp4",
            //   title: "Winter Wonderland",
            //   desc: "Snowflakes dancing in the wind",
            // }, // Added video URL
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1476231682828-37e571bc172f?w=800&h=600&fit=crop",
              title: "Autumn Colors",
              desc: "Nature's final masterpiece",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1464822759844-d150dd23607b?w=800&h=600&fit=crop",
              title: "Starry Night",
              desc: "Dreams written in starlight",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",
              title: "River Journey",
              desc: "Following the flow of time",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1481833761820-0509d3217039?w=800&h=600&fit=crop",
              title: "Garden Bloom",
              desc: "Where life flourishes",
            },
            // {
            //   type: "video",
            //   url: "https://www.w3schools.com/tags/movie.mp4",
            //   title: "Spring Awakening",
            //   desc: "Nature coming back to life",
            // }, // Added video URL
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop",
              title: "Cloud Dancing",
              desc: "Sky artistry in motion",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&h=600&fit=crop",
              title: "Morning Dew",
              desc: "Fresh beginnings",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=800&h=600&fit=crop",
              title: "Sunset Dreams",
              desc: "Day's beautiful farewell",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&h=600&fit=crop",
              title: "Valley Vista",
              desc: "Panoramic perfection",
            },
            // {
            //   type: "video",
            //   url: "https://www.w3schools.com/html/mov_bbb.mp4",
            //   title: "Ocean Rhythm",
            //   desc: "Waves singing their eternal song",
            // }, // Added video URL
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=800&h=600&fit=crop",
              title: "Desert Sunrise",
              desc: "First light over the dunes",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?w=800&h=600&fit=crop",
              title: "City Skyline",
              desc: "Modern monuments reaching high",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=800&h=600&fit=crop",
              title: "Peaceful Waters",
              desc: "Calm in a chaotic world",
            },
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1476231682828-37e571bc172f?w=800&h=600&fit=crop",
              title: "Golden Leaves",
              desc: "Time's beautiful transition",
            },
            // {
            //   type: "video",
            //   url: "https://www.w3schools.com/html/movie.mp4",
            //   title: "Night Sky Time-lapse",
            //   desc: "Stars painting stories above",
            // }, // Added video URL
            {
              type: "photo",
              url: "https://images.unsplash.com/photo-1464822759844-d150dd23607b?w=800&h=600&fit=crop",
              title: "Final Memory",
              desc: "The end of a perfect journey",
            },
          ];

          return photos;
        }

        init() {
          this.createMediaItems();
          this.createThumbnails();
          this.bindEvents();
          this.updateCounter(); // Initial counter update
        }

        createMediaItems() {
          const mainDisplay = document.getElementById("mainDisplay");

          // Clear existing items except navigation and controls
          const existingItems = mainDisplay.querySelectorAll(".media-item");
          existingItems.forEach((item) => item.remove());

          this.mediaData.forEach((media, index) => {
            const mediaItem = document.createElement("div");
            mediaItem.className = `media-item ${index === 0 ? "active" : ""}`;
            mediaItem.setAttribute("data-index", index);

            if (media.type === "photo") {
              mediaItem.innerHTML = `
                            <img src="${media.url}" alt="${media.title}">
                            <div class="media-info">
                                <h3>${media.title}</h3>
                                <p>${media.desc}</p>
                            </div>
                        `;
            } else {
              // For videos, create a video element and a play button
              mediaItem.innerHTML = `
                            <video src="${media.url}" controls preload="metadata" style="display:none;"></video>
                            <div class="video-placeholder">
                                ðŸ“¹ ${media.title}
                                <div class="play-button"></div>
                            </div>
                            <div class="media-info">
                                <h3>${media.title}</h3>
                                <p>${media.desc}</p>
                            </div>
                        `;
              const videoElement = mediaItem.querySelector("video");
              const playButton = mediaItem.querySelector(".play-button");
              const videoPlaceholder = mediaItem.querySelector(".video-placeholder");

              playButton.addEventListener("click", () => {
                this.handleVideoPlay(videoElement, videoPlaceholder, playButton);
              });

              videoElement.addEventListener("play", () => {
                isVideoPlaying = true;
                if (this.backgroundAudio && isPlaying) {
                  // Use this.backgroundAudio
                  this.backgroundAudio.pause();
                }
                // Pause autoplay if a video starts playing
                if (this.isAutoplay) {
                  this.toggleAutoplay();
                }
              });

              videoElement.addEventListener("pause", () => {
                isVideoPlaying = false;
                if (this.backgroundAudio && isPlaying) {
                  // Use this.backgroundAudio
                  this.backgroundAudio.play().catch((e) => console.log("Background music resume failed:", e));
                }
              });

              videoElement.addEventListener("ended", () => {
                isVideoPlaying = false;
                if (this.backgroundAudio && isPlaying) {
                  // Use this.backgroundAudio
                  this.backgroundAudio.play().catch((e) => console.log("Background music resume failed:", e));
                }
                // Hide video and show placeholder again
                videoElement.style.display = "none";
                videoPlaceholder.style.display = "flex";
              });
            }

            mainDisplay.appendChild(mediaItem);
          });
        }

        handleVideoPlay(videoElement, videoPlaceholder, playButton) {
          // Pause any other playing video first
          document.querySelectorAll(".media-item video").forEach((vid) => {
            if (vid !== videoElement && !vid.paused) {
              vid.pause();
              vid.style.display = "none";
              vid.closest(".media-item").querySelector(".video-placeholder").style.display = "flex";
            }
          });

          videoPlaceholder.style.display = "none";
          videoElement.style.display = "block";
          videoElement.play().catch((e) => console.log("Video play failed:", e));
        }

        createThumbnails() {
          const thumbnails = document.getElementById("thumbnails");
          thumbnails.innerHTML = "";

          this.mediaData.forEach((media, index) => {
            const thumbnail = document.createElement("div");
            thumbnail.className = `thumbnail ${media.type} ${index === 0 ? "active" : ""}`;
            thumbnail.setAttribute("data-index", index);

            if (media.type === "photo") {
              thumbnail.innerHTML = `<img src="${media.url.replace("w=800&h=600", "w=150&h=100")}" alt="${media.title}">`;
            } else {
              thumbnail.innerHTML = `ðŸ“¹<br>${index + 1}`;
            }

            thumbnail.addEventListener("click", () => this.goToSlide(index));
            thumbnails.appendChild(thumbnail);
          });
        }

        bindEvents() {
          document.getElementById("prevBtn").addEventListener("click", () => this.previousSlide());
          document.getElementById("nextBtn").addEventListener("click", () => this.nextSlide());
          // document.getElementById("autoplayBtn").addEventListener("click", () => this.toggleAutoplay()); // Autoplay button removed

          // Keyboard navigation
          document.addEventListener("keydown", (e) => {
            if (e.key === "ArrowLeft") this.previousSlide();
            if (e.key === "ArrowRight") this.nextSlide();
            // if (e.key === " ") { // Autoplay trigger removed
            //   e.preventDefault();
            //   this.toggleAutoplay();
            // }
          });
        }

        goToSlide(index) {
          if (index === this.currentIndex) return;

          // Pause any playing video before switching slides
          const currentMediaItem = document.querySelector(".media-item.active");
          if (currentMediaItem && currentMediaItem.querySelector("video")) {
            const video = currentMediaItem.querySelector("video");
            if (!video.paused) {
              video.pause();
              video.style.display = "none";
              currentMediaItem.querySelector(".video-placeholder").style.display = "flex";
            }
          }

          // Update active media item
          document.querySelectorAll(".media-item").forEach((item) => item.classList.remove("active"));
          document.querySelectorAll(".thumbnail").forEach((item) => item.classList.remove("active"));

          document.querySelector(`.media-item[data-index="${index}"]`).classList.add("active");
          document.querySelector(`.thumbnail[data-index="${index}"]`).classList.add("active");

          this.currentIndex = index;
          this.updateCounter();

          // Scroll thumbnail into view
          const activeThumbnail = document.querySelector(`.thumbnail[data-index="${index}"]`);
          activeThumbnail.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "center" });
        }

        nextSlide() {
          const nextIndex = (this.currentIndex + 1) % this.mediaData.length;
          this.goToSlide(nextIndex);
        }

        previousSlide() {
          const prevIndex = (this.currentIndex - 1 + this.mediaData.length) % this.mediaData.length;
          this.goToSlide(prevIndex);
        }

        // Autoplay function removed as per instruction
        // toggleAutoplay() {
        //   const btn = document.getElementById("autoplayBtn");

        //   if (this.isAutoplay) {
        //     clearInterval(this.autoplayInterval);
        //     this.isAutoplay = false;
        //     btn.textContent = "â–¶ Auto Play";
        //     btn.classList.remove("active");
        //   } else {
        //     // If a video is playing, pause it and then start autoplay
        //     const currentMediaItem = document.querySelector(".media-item.active");
        //     if (currentMediaItem && currentMediaItem.querySelector("video")) {
        //       const video = currentMediaItem.querySelector("video");
        //       if (!video.paused) {
        //         video.pause();
        //         video.style.display = "none";
        //         currentMediaItem.querySelector(".video-placeholder").style.display = "flex";
        //       }
        //     }
        //     this.autoplayInterval = setInterval(() => this.nextSlide(), 3000);
        //     this.isAutoplay = true;
        //     btn.textContent = "â¸ Pause";
        //     btn.classList.add("active");
        //   }
        // }

        updateCounter() {
          document.getElementById("mediaCounter").textContent = `${this.currentIndex + 1} / ${this.mediaData.length}`;
        }
      }

      // Farewell Letter Functions
      function showFarewellLetterEnvelope() {
        const farewellEnvelopeWrapper = document.getElementById("farewellEnvelopeWrapper");
        farewellEnvelopeWrapper.classList.add("visible");
        // Scroll to the envelope
        farewellEnvelopeWrapper.scrollIntoView({ behavior: "smooth", block: "center" });
      }

      function openFarewellLetterFullscreen() {
        const farewellEnvelope = document.getElementById("farewellEnvelope");
        const farewellLetterSection = document.getElementById("farewell-letter-section");
        const farewellLetterContent = document.getElementById("farewellLetterContent");

        // Open the envelope animation
        farewellEnvelope.classList.add("open");
        farewellEnvelope.classList.remove("close");

        // Delay showing the full-screen letter slightly after the envelope opens
        setTimeout(() => {
          farewellLetterSection.classList.add("visible");
          startFarewellTypingEffect();
        }, 1000); // 1 second delay for envelope animation
      }

      function closeFarewellLetterFullscreen() {
        const farewellEnvelope = document.getElementById("farewellEnvelope");
        const farewellLetterSection = document.getElementById("farewell-letter-section");
        const farewellLetterContent = document.getElementById("farewellLetterContent");

        stopFarewellTypingEffect();
        farewellLetterSection.classList.remove("visible");
        farewellLetterContent.textContent = ""; // Clear the text immediately

        // Close the envelope animation
        farewellEnvelope.classList.add("close");
        farewellEnvelope.classList.remove("open");
      }

      function startFarewellTypingEffect() {
        farewellCharIndex = 0;
        document.getElementById("farewellLetterContent").textContent = ""; // Clear previous text
        stopFarewellTypingEffect(); // Clear any existing interval before starting a new one

        farewellTypingInterval = setInterval(() => {
          if (farewellCharIndex < fullFarewellContent.length) {
            document.getElementById("farewellLetterContent").textContent +=
              fullFarewellContent.charAt(farewellCharIndex);
            farewellCharIndex++;
          } else {
            stopFarewellTypingEffect(); // Stop when all characters are typed
          }
        }, 50); // Typing speed (milliseconds per character)
      }

      function stopFarewellTypingEffect() {
        clearInterval(farewellTypingInterval);
      }

      // Curtain reveal function from welcome.html
      function reveal() {
          const leftCurtain = document.querySelector(".rnInner");
          const rightCurtain = document.querySelector(".rnInnerRight");
          
          if (leftCurtain) leftCurtain.classList.add("open");
          if (rightCurtain) rightCurtain.classList.add("open");
          
          setTimeout(() => {
              const curtain = document.querySelector("#curtain");
              if (curtain) curtain.classList.add("d-none"); // Use d-none to hide it completely
              
              // After curtain opens, show main content and start animations
              const mainContent = document.getElementById("mainContent");
              if (mainContent) {
                  mainContent.style.display = "block"; // Make main content visible
                  // Add a class to trigger the fade-in animation
                  mainContent.classList.add('fade-in-content'); 
              }
              startAnimations();
              setupScrollAnimations();
              initAudioOnInteraction(); // Activate audio after curtain opens
          }, 4000); // Match the curtain transition duration
      }

      // Snow effect function from welcome.html
      let confettiId = null; // Define confettiId globally for snow function
      function snow(event) {
          console.log('Snow effect triggered', event.target);
          
          const duration = 60 * 1000;
          const animationEnd = Date.now() + duration;
          let skew = 1;
          
          function randomInRange(min, max) {
              return Math.random() * (max - min) + min;
          }
          
          (function frame() {
              const timeLeft = animationEnd - Date.now();
              const ticks = Math.max(200, 500 * (timeLeft / duration));
              
              skew = Math.max(0.8, skew - 0.001);
              
              confetti({
                  particleCount: 1,
                  startVelocity: 0,
                  ticks: ticks,
                  origin: {
                      x: Math.random(),
                      y: (Math.random() * skew) - 0.2
                  },
                  colors: ['#af3d5f', '#e22016'],
                  shapes: ['circle'],
                  gravity: randomInRange(0.4, 0.6),
                  scalar: randomInRange(0.4, 1),
                  drift: randomInRange(-0.4, 0.4)
              });
              
              if (timeLeft > 0) {
                  requestAnimationFrame(frame);
              }
          }());
      }

      // Enhanced Event Listeners

      // Album code input validation
      document.getElementById("albumCode").addEventListener("input", function (e) {
        this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, "");
      });

      // Enter key support for album access
      document.getElementById("albumCode").addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          verifyAlbumAccess();
        }
      });

      // Guest code input validation
      document.getElementById("guestCode").addEventListener("input", function (e) {
        this.value = this.value.replace(/[^0-9]/g, "");
      });

      // Enter key support for invitation form
      document.getElementById("guestCode").addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          downloadInvitation();
        }
      });

      document.getElementById("guestName").addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          document.getElementById("guestCode").focus();
        }
      });

      // Enhanced Keyboard navigation
      document.addEventListener("keydown", function (e) {
        // Album access modal
        const albumModal = document.getElementById("albumAccessModal");
        if (albumModal.classList.contains("active") && e.key === "Escape") {
          closeAlbumModal();
        }

        // Invitation modal
        const inviteModal = document.getElementById("invitationModal");
        if (inviteModal.classList.contains("active") && e.key === "Escape") {
          closeModal();
        }

        // Farewell letter fullscreen
        const farewellLetterSection = document.getElementById("farewell-letter-section");
        if (farewellLetterSection.classList.contains("visible") && e.key === "Escape") {
          closeFarewellLetterFullscreen();
        }

        // Curtain interaction
        const curtain = document.querySelector('#curtain');
        if (e.code === 'Space' || e.key === 'Enter') {
            if (curtain && curtain.style.display !== 'none' && !curtain.classList.contains('d-none')) {
                reveal();
                snow(e);
            }
        }
      });

      // Close modals on background click
      document.getElementById("albumAccessModal").addEventListener("click", function (e) {
        if (e.target === this) closeAlbumModal();
      });

      document.getElementById("invitationModal").addEventListener("click", function (e) {
        if (e.target === this) closeModal();
      });

      // Close farewell letter fullscreen on background click
      document.getElementById("farewell-letter-section").addEventListener("click", function (e) {
        if (e.target === this) closeFarewellLetterFullscreen();
      });

      // Handle visibility change for audio
      document.addEventListener("visibilitychange", function () {
        if (audio && isPlaying && !isVideoPlaying && !isFlipbookMusicPlaying) {
          // Only pause/play if no video or flipbook music is active
          if (document.hidden) {
            audio.pause();
          } else {
            audio.play().catch(console.log);
          }
        }
        if (flipbookAudio && isFlipbookMusicPlaying) {
          if (document.hidden) {
            flipbookAudio.pause();
          } else {
            flipbookAudio.play().catch(console.log);
          }
        }
      });

      // Farewell Envelope Click Listener
      document.getElementById("farewellEnvelope").addEventListener("click", function () {
        openFarewellLetterFullscreen();
      });

      // Farewell Close Button Listener
      document.getElementById("farewellCloseBtn").addEventListener("click", function () {
        closeFarewellLetterFullscreen();
      });

      // Curtain click listener
      document.getElementById("curtain").addEventListener("click", function(event) {
          if (this.style.display !== 'none' && !this.classList.contains('d-none')) {
              reveal();
              snow(event);
          }
      });

      // Add touch support for mobile for curtain
      let touchStartY = 0;
      document.addEventListener('touchstart', function(event) {
          touchStartY = event.touches[0].clientY;
      });
      
      document.addEventListener('touchend', function(event) {
          const touchEndY = event.changedTouches[0].clientY;
          const curtain = document.querySelector('#curtain');
          
          if (Math.abs(touchStartY - touchEndY) > 50 && curtain && curtain.style.display !== 'none' && !curtain.classList.contains('d-none')) {
              reveal();
              snow(event);
          }
      });


      // Enhanced Console messages
      console.log(
        "%cFarewell Celebration ðŸŽ‰",
        "color: #ffd700; font-weight: bold; font-size: 24px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);"
      );
      console.log("%cAlbum Access Code: 12BL25", "color: #4ecdc4; font-weight: bold; font-size: 16px;");
      console.log(
        "%cYour presence makes this celebration complete!",
        "color: #ff6b6b; font-style: italic; font-size: 14px;"
      );

      // Add success popup animation CSS
      const style = document.createElement("style");
      style.textContent = `
            @keyframes successPop {
                0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.9; }
                100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            }
        `;
      document.head.appendChild(style);

      // Initialize the new photo album when the page loads
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize audio element here, but don't play it yet
        audio = document.getElementById("backgroundMusic");
        flipbookAudio = document.getElementById("flipbookMusic"); // Initialize flipbook music
        photoAlbumInstance = new PhotoAlbum(audio); // Pass the audio element to the PhotoAlbum constructor
      });


        new Vue({
        el: "#app",
        data() {
          return {
            currentPage: 0,
            totalPages: 0,
            items: [
              {
                img1: "https://picsum.photos/id/24/600/600",
               // img2: "https://picsum.photos/id/25/600/600",
               // img3: "https://picsum.photos/id/26/600/600",
                img4: "https://picsum.photos/id/39/600/600",
                img5: "https://picsum.photos/id/40/600/600",
                img6: "https://picsum.photos/id/41/600/600",
                img7: "https://picsum.photos/id/42/600/600",
                title: "Memories Together",
                textBack: "A lovely group enjoying their time together, creating unforgettable moments.",
              },
              {
                img1: "https://picsum.photos/id/27/600/600",
                img2: "https://picsum.photos/id/28/600/600",
                img3: "https://picsum.photos/id/29/600/600",
                img4: "https://picsum.photos/id/43/600/600",
                img5: "https://picsum.photos/id/44/600/600",
                img6: "https://picsum.photos/id/45/600/600",
                img7: "https://picsum.photos/id/46/600/600",
                title: "Adventure Days",
                textBack: "Absolutely adorable moments captured during our adventures together.",
              },
              {
                img1: "https://picsum.photos/id/30/600/600",
                img2: "https://picsum.photos/id/31/600/600",
                img3: "https://picsum.photos/id/32/600/600",
                img4: "https://picsum.photos/id/47/600/600",
                img5: "https://picsum.photos/id/48/600/600",
                img6: "https://picsum.photos/id/49/600/600",
                img7: "https://picsum.photos/id/50/600/600",
                title: "Fun Times",
                textBack: "Joyful moments and endless laughter shared together.",
              },
              {
                img1: "https://picsum.photos/id/33/600/600",
                img2: "https://picsum.photos/id/34/600/600",
                img3: "https://picsum.photos/id/35/600/600",
                img4: "https://picsum.photos/id/51/600/600",
                img5: "https://picsum.photos/id/52/600/600",
                img6: "https://picsum.photos/id/53/600/600",
                img7: "https://picsum.photos/id/54/600/600",
                title: "Special Moments",
                textBack: "Peaceful times and sweet dreams shared together.",
              },
              {
                img1: "https://picsum.photos/id/36/600/600",
                img2: "https://picsum.photos/id/37/600/600",
                img3: "https://picsum.photos/id/38/600/600",
                img4: "https://picsum.photos/id/55/600/600",
                img5: "https://picsum.photos/id/56/600/600",
                img6: "https://picsum.photos/id/57/600/600",
                img7: "https://picsum.photos/id/58/600/600",
                title: "Final Memories",
                textBack: "Our cherished friends, always by our side through every moment.",
              },
            ],
            zoomedImage: null,
            elBook: null,
          };
        },
        mounted() {
          // Ensure the DOM is ready before accessing $refs
          this.$nextTick(() => {
            this.initFlipBook();
          });
        },
        methods: {
          initFlipBook() {
            this.elBook = this.$refs.book;
            if (!this.elBook) {
              console.error("Flipbook element not found.");
              return;
            }
            this.elBook.style.setProperty("--c", this.currentPage);
            
            const pages = this.elBook.querySelectorAll(".page");
            this.totalPages = pages.length;
            
            pages.forEach((page, idx) => {
              page.style.setProperty("--i", idx);
              // Remove the click listener on individual pages to prevent opening on click
              // page.addEventListener("click", (evt) => {
              //   if (evt.target.closest(".content__img-wrapper")) return;
              //   if (this.zoomedImage) return;
              //   const curr = evt.target.closest(".back") ? idx : idx + 1;
              //   this.goToPage(curr);
              // });
            });
          },
          goToPage(pageIndex) {
            if (pageIndex >= 0 && pageIndex < this.totalPages) {
              this.currentPage = pageIndex;
              this.elBook.style.setProperty("--c", this.currentPage);
            }
          },
          nextPage() {
            if (this.currentPage < this.totalPages - 1) {
              this.goToPage(this.currentPage + 1);
              // Play flipbook music when opening the book (moving to next page)
              if (this.currentPage === 1 && flipbookAudio) { // Assuming page 1 is the first content page
                if (audio && isPlaying) { // Check if background music is playing
                  audio.pause();
                }
                flipbookAudio.play().catch(e => console.error("Flipbook music play failed:", e));
                isFlipbookMusicPlaying = true; // Set flipbook music playing flag to true
              }
            } else {
              // If at the last page, automatically close the book and stop flipbook music
              this.closeBook();
            }
          },
          previousPage() {
            if (this.currentPage > 0) {
              this.goToPage(this.currentPage - 1);
              // If moving back to the cover page, stop flipbook music
              if (this.currentPage === 0 && flipbookAudio && isFlipbookMusicPlaying) {
                flipbookAudio.pause();
                flipbookAudio.currentTime = 0; // Reset music
                isFlipbookMusicPlaying = false;
                if (audio && isPlaying) {
                  audio.play().catch(e => console.error("Background music resume failed:", e));
                }
              }
            }
            // Prevent closing if not at the first page, unless it's the very first page (index 0)
            if (this.currentPage === 0) {
              this.closeBook();
            }
          },
          closeBook() {
            this.goToPage(0); // Go back to the first cover page
            if (flipbookAudio && isFlipbookMusicPlaying) {
              flipbookAudio.pause();
              flipbookAudio.currentTime = 0; // Reset music
              isFlipbookMusicPlaying = false;
              if (audio && isPlaying) {
                audio.play().catch(e => console.error("Background music resume failed:", e));
              }
            }
          },
          zoomImage(imageUrl) {
            this.zoomedImage = imageUrl;
            document.body.style.overflow = 'hidden';
          },
          closeZoom() {
            this.zoomedImage = null;
            document.body.style.overflow = 'auto'; // Corrected to 'auto'
          },
        },
      });
    </script>
  </body>
</html>
